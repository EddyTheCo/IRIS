#include"iris.hpp"
namespace custom_models{
	namespace datasets{

		IRIS::IRIS(const std::string &root, Mode mode):is_train_(mode==Mode::kTrain)
		{
			if(mode==Mode::kTrain)
			{
				images_=torch::tensor({7.088607594936707779e-01, 6.136363636363636465e-01, 6.086956521739130821e-01, 5.200000000000000178e-01,
						6.835443037974683334e-01, 8.409090909090908283e-01, 2.173913043478260809e-01, 8.000000000000000167e-02,
						7.721518987341771112e-01, 6.818181818181817677e-01, 6.666666666666666297e-01, 5.599999999999999423e-01,
						6.455696202531644445e-01, 7.499999999999998890e-01, 2.463768115942028825e-01, 2.000000000000000111e-01,
						9.620253164556961112e-01, 6.818181818181817677e-01, 9.565217391304347005e-01, 8.400000000000000799e-01,
						8.101265822784810000e-01, 6.363636363636362425e-01, 8.115942028985506651e-01, 8.800000000000001155e-01,
						7.088607594936707779e-01, 6.818181818181817677e-01, 6.521739130434782705e-01, 5.999999999999999778e-01,
						7.974683544303796667e-01, 7.499999999999998890e-01, 6.811594202898550998e-01, 6.400000000000000133e-01,
						7.974683544303796667e-01, 6.363636363636362425e-01, 7.391304347826086474e-01, 5.999999999999999778e-01,
						6.455696202531644445e-01, 8.636363636363635354e-01, 2.173913043478260809e-01, 1.199999999999999956e-01,
						7.468354430379746667e-01, 6.818181818181817677e-01, 7.391304347826086474e-01, 7.199999999999999734e-01,
						8.227848101265822223e-01, 6.818181818181817677e-01, 7.536231884057971175e-01, 8.000000000000000444e-01,
						6.708860759493670001e-01, 8.409090909090908283e-01, 2.173913043478260809e-01, 8.000000000000000167e-02,
						7.848101265822784445e-01, 7.727272727272725961e-01, 7.826086956521739468e-01, 9.199999999999999289e-01,
						7.468354430379746667e-01, 6.818181818181817677e-01, 6.086956521739130821e-01, 5.999999999999999778e-01,
						6.962025316455695556e-01, 9.545454545454544748e-01, 2.028985507246376663e-01, 8.000000000000000167e-02,
						5.949367088607594445e-01, 7.272727272727272929e-01, 1.884057971014492794e-01, 8.000000000000000167e-02,
						6.835443037974683334e-01, 7.727272727272725961e-01, 2.463768115942028825e-01, 8.000000000000000167e-02,
						6.455696202531644445e-01, 7.954545454545454142e-01, 2.028985507246376663e-01, 8.000000000000000167e-02,
						6.075949367088606667e-01, 6.818181818181817677e-01, 2.028985507246376663e-01, 1.199999999999999956e-01,
						6.455696202531644445e-01, 8.636363636363635354e-01, 2.318840579710144956e-01, 8.000000000000000167e-02,
						7.594936708860758889e-01, 6.590909090909090606e-01, 6.521739130434782705e-01, 5.999999999999999778e-01,
						6.329113924050632223e-01, 6.818181818181817677e-01, 2.318840579710144956e-01, 8.000000000000000167e-02,
						9.113924050632911111e-01, 8.181818181818181213e-01, 8.840579710144926828e-01, 1.000000000000000000e+00,
						6.582278481012657778e-01, 6.136363636363636465e-01, 5.652173913043477826e-01, 5.599999999999999423e-01,
						8.481012658227847778e-01, 7.499999999999998890e-01, 8.260869565217391353e-01, 8.400000000000000799e-01,
						6.582278481012657778e-01, 9.318181818181816567e-01, 2.173913043478260809e-01, 4.000000000000000083e-02,
						5.822784810126581112e-01, 7.045454545454544748e-01, 2.173913043478260809e-01, 8.000000000000000167e-02,
						7.215189873417721111e-01, 1.000000000000000000e+00, 2.173913043478260809e-01, 1.600000000000000033e-01,
						7.974683544303796667e-01, 5.681818181818181213e-01, 7.101449275362319291e-01, 5.999999999999999778e-01,
						7.215189873417721111e-01, 6.363636363636362425e-01, 6.521739130434782705e-01, 5.200000000000000178e-01,
						9.367088607594936667e-01, 6.363636363636362425e-01, 8.840579710144926828e-01, 7.600000000000000089e-01,
						7.594936708860758889e-01, 5.000000000000000000e-01, 5.797101449275362528e-01, 4.000000000000000222e-01,
						8.101265822784810000e-01, 6.590909090909090606e-01, 6.231884057971014412e-01, 5.200000000000000178e-01,
						8.101265822784810000e-01, 7.045454545454544748e-01, 7.971014492753623060e-01, 7.199999999999999734e-01,
						7.215189873417721111e-01, 6.363636363636362425e-01, 5.942028985507245009e-01, 5.200000000000000178e-01,
						7.974683544303796667e-01, 6.590909090909090606e-01, 8.115942028985506651e-01, 7.199999999999999734e-01,
						5.822784810126581112e-01, 7.272727272727272929e-01, 2.028985507246376663e-01, 8.000000000000000167e-02,
						1.000000000000000000e+00, 8.636363636363635354e-01, 9.275362318840579823e-01, 8.000000000000000444e-01,
						7.468354430379746667e-01, 7.272727272727272929e-01, 6.956521739130434590e-01, 7.199999999999999734e-01,
						6.329113924050632223e-01, 7.954545454545454142e-01, 1.884057971014492794e-01, 1.199999999999999956e-01,
						8.734177215189873333e-01, 7.045454545454544748e-01, 7.101449275362319291e-01, 5.999999999999999778e-01,
						6.329113924050632223e-01, 7.954545454545454142e-01, 2.318840579710144956e-01, 2.399999999999999911e-01,
						7.974683544303796667e-01, 7.727272727272725961e-01, 8.115942028985506651e-01, 9.599999999999999645e-01,
						6.962025316455695556e-01, 5.454545454545454142e-01, 5.362318840579710644e-01, 4.000000000000000222e-01,
						6.202531645569620000e-01, 5.454545454545454142e-01, 4.782608695652173503e-01, 4.000000000000000222e-01,
						6.962025316455695556e-01, 5.681818181818181213e-01, 5.797101449275362528e-01, 5.200000000000000178e-01,
						7.088607594936707779e-01, 5.681818181818181213e-01, 5.652173913043477826e-01, 4.400000000000000577e-01,
						6.329113924050632223e-01, 4.545454545454545303e-01, 5.072463768115941241e-01, 4.000000000000000222e-01,
						6.835443037974683334e-01, 7.727272727272725961e-01, 2.173913043478260809e-01, 1.600000000000000033e-01,
						6.962025316455695556e-01, 5.454545454545454142e-01, 5.507246376811593125e-01, 4.400000000000000577e-01,
						6.202531645569620000e-01, 7.045454545454544748e-01, 2.173913043478260809e-01, 4.000000000000000083e-02,
						9.746835443037974445e-01, 8.636363636363635354e-01, 9.710144927536231707e-01, 8.800000000000001155e-01,
						6.202531645569620000e-01, 6.818181818181817677e-01, 2.028985507246376663e-01, 8.000000000000000167e-02,
						6.962025316455695556e-01, 5.227272727272725961e-01, 5.797101449275362528e-01, 5.200000000000000178e-01,
						6.202531645569620000e-01, 7.045454545454544748e-01, 2.173913043478260809e-01, 4.000000000000000083e-02,
						7.088607594936707779e-01, 6.363636363636362425e-01, 7.101449275362319291e-01, 8.000000000000000444e-01,
						7.721518987341771112e-01, 5.909090909090908283e-01, 8.115942028985506651e-01, 5.599999999999999423e-01,
						6.329113924050632223e-01, 7.272727272727272929e-01, 1.739130434782608647e-01, 8.000000000000000167e-02,
						5.569620253164556667e-01, 7.272727272727272929e-01, 1.884057971014492794e-01, 8.000000000000000167e-02,
						6.329113924050632223e-01, 7.727272727272725961e-01, 2.173913043478260809e-01, 8.000000000000000167e-02,
						8.860759493670885556e-01, 7.272727272727272929e-01, 6.811594202898550998e-01, 5.599999999999999423e-01,
						9.113924050632911111e-01, 6.818181818181817677e-01, 8.405797101449274944e-01, 6.400000000000000133e-01,
						8.101265822784810000e-01, 7.272727272727272929e-01, 6.521739130434782705e-01, 5.999999999999999778e-01,
						6.202531645569620000e-01, 5.681818181818181213e-01, 6.521739130434782705e-01, 6.799999999999999378e-01,
						7.594936708860758889e-01, 7.727272727272725961e-01, 6.521739130434782705e-01, 6.400000000000000133e-01,
						7.215189873417721111e-01, 5.681818181818181213e-01, 7.246376811594202882e-01, 8.000000000000000444e-01,
						7.341772151898733334e-01, 6.363636363636362425e-01, 7.391304347826086474e-01, 9.599999999999999645e-01,
						8.481012658227847778e-01, 7.045454545454544748e-01, 8.115942028985506651e-01, 9.599999999999999645e-01,
						8.354430379746834445e-01, 6.818181818181817677e-01, 6.376811594202899114e-01, 5.599999999999999423e-01,
						6.455696202531644445e-01, 7.727272727272725961e-01, 2.173913043478260809e-01, 8.000000000000000167e-02,
						5.569620253164556667e-01, 6.818181818181817677e-01, 1.884057971014492794e-01, 8.000000000000000167e-02,
						6.835443037974683334e-01, 8.863636363636362425e-01, 2.463768115942028825e-01, 1.600000000000000033e-01,
						8.481012658227847778e-01, 5.681818181818181213e-01, 8.405797101449274944e-01, 7.199999999999999734e-01,
						7.974683544303796667e-01, 6.136363636363636465e-01, 7.101449275362319291e-01, 7.199999999999999734e-01,
						8.481012658227847778e-01, 7.045454545454544748e-01, 6.376811594202899114e-01, 5.599999999999999423e-01,
						6.962025316455695556e-01, 5.909090909090908283e-01, 6.376811594202899114e-01, 4.799999999999999822e-01,
						8.101265822784810000e-01, 6.363636363636362425e-01, 8.115942028985506651e-01, 8.400000000000000799e-01,
						6.455696202531644445e-01, 7.954545454545454142e-01, 2.028985507246376663e-01, 1.199999999999999956e-01,
						8.481012658227847778e-01, 7.045454545454544748e-01, 6.811594202898550998e-01, 5.999999999999999778e-01,
						7.721518987341771112e-01, 6.818181818181817677e-01, 7.101449275362319291e-01, 7.199999999999999734e-01,
						8.227848101265822223e-01, 7.272727272727272929e-01, 7.391304347826086474e-01, 8.000000000000000444e-01,
						8.101265822784810000e-01, 6.136363636363636465e-01, 7.681159420289854767e-01, 7.600000000000000089e-01,
						7.088607594936707779e-01, 6.818181818181817677e-01, 5.942028985507245009e-01, 5.200000000000000178e-01,
						6.455696202531644445e-01, 5.681818181818181213e-01, 4.347826086956521618e-01, 4.400000000000000577e-01,
						6.582278481012657778e-01, 7.727272727272725961e-01, 2.028985507246376663e-01, 8.000000000000000167e-02,
						6.075949367088606667e-01, 7.727272727272725961e-01, 2.753623188405796562e-01, 8.000000000000000167e-02,
						5.949367088607594445e-01, 7.272727272727272929e-01, 2.318840579710144956e-01, 8.000000000000000167e-02,
						9.746835443037974445e-01, 6.818181818181817677e-01, 8.840579710144926828e-01, 9.199999999999999289e-01,
						7.341772151898733334e-01, 6.136363636363636465e-01, 7.391304347826086474e-01, 7.600000000000000089e-01,
						8.354430379746834445e-01, 6.590909090909090606e-01, 6.666666666666666297e-01, 5.200000000000000178e-01,
						8.481012658227847778e-01, 6.818181818181817677e-01, 7.246376811594202882e-01, 6.799999999999999378e-01,
						5.822784810126581112e-01, 7.727272727272725961e-01, 2.028985507246376663e-01, 1.199999999999999956e-01,
						7.215189873417721111e-01, 8.636363636363635354e-01, 2.463768115942028825e-01, 1.199999999999999956e-01,
						8.481012658227847778e-01, 7.499999999999998890e-01, 8.260869565217391353e-01, 1.000000000000000000e+00,
						7.848101265822784445e-01, 6.590909090909090606e-01, 6.231884057971014412e-01, 5.200000000000000178e-01,
						6.329113924050632223e-01, 7.727272727272725961e-01, 2.318840579710144956e-01, 1.600000000000000033e-01,
						8.734177215189873333e-01, 7.045454545454544748e-01, 7.391304347826086474e-01, 9.199999999999999289e-01,
						6.835443037974683334e-01, 8.863636363636362425e-01, 1.884057971014492794e-01, 1.600000000000000033e-01,
						7.721518987341771112e-01, 6.363636363636362425e-01, 5.797101449275362528e-01, 5.200000000000000178e-01,
						6.075949367088606667e-01, 6.818181818181817677e-01, 2.028985507246376663e-01, 4.000000000000000083e-02,
						7.341772151898733334e-01, 6.136363636363636465e-01, 5.652173913043477826e-01, 4.799999999999999822e-01,
						8.607594936708860001e-01, 6.363636363636362425e-01, 6.956521739130434590e-01, 5.599999999999999423e-01,
						6.962025316455695556e-01, 7.954545454545454142e-01, 1.884057971014492794e-01, 8.000000000000000167e-02,
						6.075949367088606667e-01, 7.045454545454544748e-01, 2.318840579710144956e-01, 8.000000000000000167e-02,
						6.329113924050632223e-01, 8.181818181818181213e-01, 2.028985507246376663e-01, 8.000000000000000167e-02,
						6.582278481012657778e-01, 7.954545454545454142e-01, 2.173913043478260809e-01, 8.000000000000000167e-02,
						5.569620253164556667e-01, 6.590909090909090606e-01, 2.028985507246376663e-01, 8.000000000000000167e-02,
						7.215189873417721111e-01, 6.818181818181817677e-01, 6.086956521739130821e-01, 4.799999999999999822e-01,
						8.227848101265822223e-01, 6.363636363636362425e-01, 6.666666666666666297e-01, 5.999999999999999778e-01,
						8.227848101265822223e-01, 6.818181818181817677e-01, 8.405797101449274944e-01, 8.800000000000001155e-01,
						9.746835443037974445e-01, 5.909090909090908283e-01, 1.000000000000000000e+00, 9.199999999999999289e-01,
						7.848101265822784445e-01, 5.000000000000000000e-01, 6.521739130434782705e-01, 5.999999999999999778e-01,
						9.746835443037974445e-01, 6.363636363636362425e-01, 9.710144927536231707e-01, 8.000000000000000444e-01,
						6.329113924050632223e-01, 7.499999999999998890e-01, 2.028985507246376663e-01, 8.000000000000000167e-02,
						8.987341772151897779e-01, 6.818181818181817677e-01, 8.550724637681159646e-01, 8.400000000000000799e-01,
						7.341772151898733334e-01, 6.136363636363636465e-01, 7.391304347826086474e-01, 7.600000000000000089e-01,
						7.594936708860758889e-01, 6.818181818181817677e-01, 6.956521739130434590e-01, 7.199999999999999734e-01,
						6.455696202531644445e-01, 8.409090909090908283e-01, 2.173913043478260809e-01, 1.600000000000000033e-01,
						7.215189873417721111e-01, 5.909090909090908283e-01, 5.072463768115941241e-01, 4.000000000000000222e-01},torch::dtype(at::get_default_dtype()));
				images_=images_.view({120,4});

				targets_=torch::tensor({2,
						1,
						2,
						1,
						3,
						3,
						2,
						2,
						3,
						1,
						3,
						3,
						1,
						3,
						2,
						1,
						1,
						1,
						1,
						1,
						1,
						2,
						1,
						3,
						2,
						3,
						1,
						1,
						1,
						2,
						2,
						3,
						2,
						2,
						3,
						2,
						3,
						1,
						3,
						2,
						1,
						2,
						1,
						3,
						2,
						2,
						2,
						2,
						2,
						1,
						2,
						1,
						3,
						1,
						2,
						1,
						3,
						3,
						1,
						1,
						1,
						2,
						3,
						2,
						3,
						2,
						3,
						3,
						3,
						2,
						1,
						1,
						1,
						3,
						3,
						2,
						2,
						3,
						1,
						2,
						3,
						3,
						3,
						2,
						2,
						1,
						1,
						1,
						3,
						3,
						2,
						2,
						1,
						1,
						3,
						2,
						1,
						3,
						1,
						2,
						1,
						2,
						2,
						1,
						1,
						1,
						1,
						1,
						2,
						2,
						3,
						3,
						2,
						3,
						1,
						3,
						3,
						3,
						1,
						2},{torch::kInt64});
				targets_=targets_-1;
			}
			else
			{
				images_=at::tensor({7.721518987341771112e-01, 6.590909090909090606e-01, 6.811594202898550998e-01, 5.599999999999999423e-01,
						6.835443037974683334e-01, 6.818181818181817677e-01, 6.521739130434782705e-01, 5.999999999999999778e-01,
						8.734177215189873333e-01, 7.272727272727272929e-01, 8.260869565217391353e-01, 9.199999999999999289e-01,
						9.113924050632911111e-01, 7.272727272727272929e-01, 8.695652173913043237e-01, 7.199999999999999734e-01,
						7.974683544303796667e-01, 5.227272727272725961e-01, 6.376811594202899114e-01, 5.200000000000000178e-01,
						5.822784810126581112e-01, 8.181818181818181213e-01, 1.449275362318840632e-01, 8.000000000000000167e-02,
						7.721518987341771112e-01, 6.363636363636362425e-01, 6.811594202898550998e-01, 4.799999999999999822e-01,
						7.594936708860758889e-01, 5.000000000000000000e-01, 7.246376811594202882e-01, 5.999999999999999778e-01,
						8.734177215189873333e-01, 7.045454545454544748e-01, 7.826086956521739468e-01, 8.400000000000000799e-01,
						7.341772151898733334e-01, 6.136363636363636465e-01, 5.942028985507245009e-01, 4.000000000000000222e-01,
						7.088607594936707779e-01, 6.590909090909090606e-01, 5.217391304347825942e-01, 5.200000000000000178e-01,
						6.202531645569620000e-01, 7.045454545454544748e-01, 2.173913043478260809e-01, 4.000000000000000083e-02,
						7.341772151898733334e-01, 5.909090909090908283e-01, 5.797101449275362528e-01, 4.799999999999999822e-01,
						7.848101265822784445e-01, 6.363636363636362425e-01, 6.956521739130434590e-01, 7.199999999999999734e-01,
						8.101265822784810000e-01, 7.272727272727272929e-01, 7.681159420289854767e-01, 9.199999999999999289e-01,
						7.341772151898733334e-01, 9.090909090909090606e-01, 1.739130434782608647e-01, 8.000000000000000167e-02,
						7.594936708860758889e-01, 6.136363636363636465e-01, 7.391304347826086474e-01, 6.400000000000000133e-01,
						8.227848101265822223e-01, 6.818181818181817677e-01, 7.971014492753623060e-01, 7.199999999999999734e-01,
						7.215189873417721111e-01, 6.590909090909090606e-01, 6.086956521739130821e-01, 5.200000000000000178e-01,
						6.329113924050632223e-01, 5.227272727272725961e-01, 4.782608695652173503e-01, 4.000000000000000222e-01,
						5.696202531645568889e-01, 5.227272727272725961e-01, 1.884057971014492794e-01, 1.199999999999999956e-01,
						6.075949367088606667e-01, 7.727272727272725961e-01, 2.318840579710144956e-01, 8.000000000000000167e-02,
						8.607594936708860001e-01, 7.272727272727272929e-01, 8.550724637681159646e-01, 9.199999999999999289e-01,
						9.240506329113923334e-01, 6.590909090909090606e-01, 9.130434782608695121e-01, 7.199999999999999734e-01,
						6.455696202531644445e-01, 8.636363636363635354e-01, 2.753623188405796562e-01, 1.600000000000000033e-01,
						8.481012658227847778e-01, 6.818181818181817677e-01, 7.536231884057971175e-01, 9.199999999999999289e-01,
						7.974683544303796667e-01, 5.681818181818181213e-01, 7.246376811594202882e-01, 7.600000000000000089e-01,
						5.443037974683543334e-01, 6.818181818181817677e-01, 1.594202898550724778e-01, 4.000000000000000083e-02,
						7.974683544303796667e-01, 7.499999999999998890e-01, 8.695652173913043237e-01, 1.000000000000000000e+00,
						8.607594936708860001e-01, 6.818181818181817677e-01, 7.971014492753623060e-01, 8.400000000000000799e-01},torch::dtype(at::get_default_dtype()));
				images_=images_.view({30,4});
				targets_=torch::tensor({2,
						2,
						3,
						3,
						2,
						1,
						2,
						3,
						3,
						2,
						2,
						1,
						2,
						3,
						3,
						1,
						2,
						3,
						2,
						2,
						1,
						1,
						3,
						3,
						1,
						3,
						3,
						1,
						3,
						3},{torch::kInt64});

				targets_=targets_-1;
			}
		}
		torch::data::Example<> IRIS::get(size_t index)
		{
			return torch::data::Example(images_[index],targets_[index]);
		}
		c10::optional<size_t> IRIS::size() const
		{
			return (is_train_)?120:30;
		}

	}//dataset namespace
}//custom_module namespace
